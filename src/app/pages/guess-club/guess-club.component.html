<div class="container">
    <app-header></app-header>
    <div class="w3-container w3-center w3-card w3-margin-top w3-margin-bottom w3-animate-opacity">
        <h2 class="w3-padding"><i class="fas fa-gamepad" style="margin-right: 4px;"></i>Guess the Club!</h2>

        <!-- START BUTTON -->
        <div *ngIf="clubs.length > 0 && !selectedClub && !gameOver" class="w3-margin-top">
            <button class="w3-btn w3-black w3-large" (click)="startGame()">
                <i class="fas fa-play"></i> Start Game
            </button>
        </div>

        <div class="lives-container">
            <i 
              *ngFor="let life of [].constructor(maxLives); let i = index"
              class="fas fa-heart"
              [class.lost]="i >= lives">
            </i>
          </div>
          

        <!-- GAME IN PROGRESS -->
        <div *ngIf="selectedClub && !gameOver">


            <!-- Club Logo Blurred -->

            <div class="logo-wrapper">
                <img 
                [src]="selectedClub.club_logo"
                class="club-logo"
                [ngClass]="getBlurClass()">            
            </div>


            <!-- TIMER (solo aparece cuando el juego inici√≥) -->
            <div class="w3-light-grey w3-round-xlarge w3-margin">
                <div class="w3-container w3-green w3-round-xlarge" 
                     [style.width.%]="(timeLeft / maxTime) * 100">
                    {{ timeLeft }}s
                </div>
            </div>

            <!-- HELPERS -->
<div class="helpers-container" *ngIf="selectedClub && !gameOver">

    <!-- Time Reset -->
    <button 
      class="helper-btn"
      [disabled]="timeHelpUsed"
      (click)="useTimeHelp()">
      ‚è±Ô∏è +30s
    </button>
  
    <!-- Blur Reduce -->
    <button 
      class="helper-btn"
      [disabled]="blurHelpUsed"
      (click)="useBlurHelp()">
      üëÅÔ∏è Reduce Blur
    </button>
  
  </div>
  

            <!-- OPTIONS -->
            <div class="options-container">
                <button *ngFor="let option of options"
                (click)="checkAnswer(option)"
                class="option-btn">
                <i class="fas fa-futbol"></i> {{ option }}
            </button>
        </div>


        </div>

        <!-- GAME OVER -->
        <div *ngIf="gameOver">

            <div *ngIf="showExtraLifeMessage" class="extra-life">
                ‚ù§Ô∏è Extra Life!
              </div>
            

            <!-- Club Logo Normal -->
            <div class="logo-wrapper">
                <img [src]="selectedClub.club_logo" class="club-logo">
            </div>


            <!-- Exit Message -->
            <h3 *ngIf="isCorrect">
                <i class="fas fa-check-circle"></i> Correct! It's {{ selectedClub.club_name }}!
            </h3>

            <!-- Wrong -->
            <h3 *ngIf="!isCorrect && !timeOut">
                <i class="fas fa-times-circle"></i> Wrong! The correct answer was {{ selectedClub.club_name }}.
            </h3>

            <!-- Time‚Äôs up -->
            <h3 *ngIf="timeOut">
                <i class="fas fa-clock"></i> Time's up! The correct answer was {{ selectedClub.club_name }}.
            </h3>

            <!-- Streak -->
            <h3 *ngIf="lives > 0">
                üî• Current Streak: {{ streak }}
              </h3>
              


            <!-- FINAL SCORE (solo cuando perdi√≥ todas las vidas) -->
            <h3 *ngIf="lives === 0">
                You got {{ lastScore }} correct answers in total!
            </h3>
  
            <!-- Player Level (solo cuando perdi√≥ todas las vidas) -->
            <h3 class="w3-margin-top" *ngIf="lives === 0">
                {{ getPlayerLevel() }}
            </h3>
  

            <!-- Restart / Next -->
            <button (click)="startGame()" class="w3-btn w3-margin w3-black">
                <i class="fas" 
                   [ngClass]="lives === 0 ? 'fa-redo' : 'fa-arrow-right'"></i> 
                {{ lives === 0 ? 'Play Again' : 'Next' }}
              </button>
              

            <!-- Share -->
            <button *ngIf="lives === 0"
            (click)="shareResult()" 
            class="w3-btn w3-margin w3-black">
            <i class="fa-brands fa-x-twitter"></i> Share on X
          </button>
          

    </div>
    </div>
    <app-footer></app-footer>
</div>
