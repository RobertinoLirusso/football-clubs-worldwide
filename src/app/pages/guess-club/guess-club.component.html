<div class="container">
    <app-header></app-header>
    <div class="w3-container w3-center w3-card w3-margin-top w3-margin-bottom w3-animate-opacity">
        <h2 class="w3-padding"><i class="fas fa-gamepad" style="margin-right: 4px;"></i>Guess the Club!</h2>

        <!-- START BUTTON -->
        <div *ngIf="clubs.length > 0 && !selectedClub && !gameOver" class="w3-margin-top">
            <button class="w3-btn w3-black w3-large" (click)="startGame()">
                <i class="fas fa-play"></i> Start Game
            </button>
        </div>

        <!-- GAME IN PROGRESS -->
        <div *ngIf="selectedClub && !gameOver">

            <!-- Club Logo Blurred -->

            <div class="logo-wrapper">
                <img [src]="selectedClub.club_logo" class="club-logo blurred">
            </div>


            <!-- TIMER (solo aparece cuando el juego inició) -->
            <div class="w3-light-grey w3-round-xlarge w3-margin">
                <div class="w3-container w3-green w3-round-xlarge" 
                     [style.width.%]="(timeLeft / maxTime) * 100">
                    {{ timeLeft }}s
                </div>
            </div>

            <!-- OPTIONS -->
            <div class="options-container">
                <button *ngFor="let option of options"
                (click)="checkAnswer(option)"
                class="option-btn">
                <i class="fas fa-futbol"></i> {{ option }}
            </button>
        </div>


        </div>

        <!-- GAME OVER -->
        <div *ngIf="gameOver">

            <!-- Club Logo Normal -->
            <div class="logo-wrapper">
                <img [src]="selectedClub.club_logo" class="club-logo">
            </div>


            <!-- Exit Message -->
            <h3 *ngIf="isCorrect">
                <i class="fas fa-check-circle"></i> Correct! It's {{ selectedClub.club_name }}!
            </h3>

            <!-- Wrong -->
            <h3 *ngIf="!isCorrect && !timeOut">
                <i class="fas fa-times-circle"></i> Wrong! The correct answer was {{ selectedClub.club_name }}.
            </h3>

            <!-- Time’s up -->
            <h3 *ngIf="timeOut">
                <i class="fas fa-clock"></i> Time's up! The correct answer was {{ selectedClub.club_name }}.
            </h3>

            <!-- Streak -->
            <h3 *ngIf="isCorrect">
                Your Streak: {{ streak }} correct answers in a row!
            </h3>

            <!-- Final Score -->
            <h3 *ngIf="!isCorrect">
                You got {{ lastScore }} correct answers in total!
            </h3>

            <!-- Player Level -->
            <h3 class="w3-margin-top" *ngIf="!isCorrect || timeOut">  
                {{ getPlayerLevel() }}
            </h3>

            <!-- Restart / Next -->
            <button (click)="startGame()" class="w3-btn w3-margin w3-black">
                <i class="fas" [ngClass]="isCorrect ? 'fa-arrow-right' : 'fa-redo'"></i> 
                {{ isCorrect ? 'Next' : 'Play Again' }}
            </button>

            <!-- Share -->
            <button *ngIf="!isCorrect || timeOut"
            (click)="shareResult()" 
            class="w3-btn w3-margin w3-black">
            <i class="fa-brands fa-x-twitter"></i> Share on X
            </button>

    </div>
    </div>
    <app-footer></app-footer>
</div>
